 {{
    config(
        materialized='incremental'
    )
}}

with stg as (

SELECT
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TEST_DATA_UNIQUE_ID,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TOT_COL_WDTH,
IFF(TC_ALIGN_DEC=1,'TRUE','FALSE') as TC_ALIGN_DEC,
TC_ALIGNMNT,
IFF(TC_ISEXPECTED=1,'TRUE','FALSE') as TC_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_CONTXT_NM,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_LBL,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_UNT,
IFF(TC_ALLOW_SCAL=1,'TRUE','FALSE') as TC_ALLOW_SCAL,
IFF(TC_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as TC_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_WDTH_MIN,
IFF(TC_WDTH_FIX=1,'TRUE','FALSE') as TC_WDTH_FIX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TC_INDENT,
IFF(COL2_ALIGN_DEC=1,'TRUE','FALSE') as COL2_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_ALIGNMNT,
IFF(COL2_ISEXPECTED=1,'TRUE','FALSE') as COL2_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_CONTXT_NM,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_LBL,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_UNT,
IFF(COL2_ALLOW_SCAL=1,'TRUE','FALSE') as COL2_ALLOW_SCAL,
IFF(COL2_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL2_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_WDTH_MIN,
IFF(COL2_WDTH_FIX=1,'TRUE','FALSE') as COL2_WDTH_FIX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL2_INDENT,
IFF(COL3_ALIGN_DEC=1,'TRUE','FALSE') as COL3_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_ALIGNMNT,
IFF(COL3_ISEXPECTED=1,'TRUE','FALSE') as COL3_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_CONTXT_NM,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_LBL,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_UNT,
IFF(COL3_ALLOW_SCAL=1,'TRUE','FALSE') as COL3_ALLOW_SCAL,
IFF(COL3_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL3_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_WDTH_MIN,
IFF(COL3_WDTH_FIX=1,'TRUE','FALSE') as COL3_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL3_INDENT, 
IFF(COL4_ALIGN_DEC=1,'TRUE','FALSE') as COL4_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_ALIGNMNT,
IFF(COL4_ISEXPECTED=1,'TRUE','FALSE') as COL4_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_UNT, 
IFF(COL4_ALLOW_SCAL=1,'TRUE','FALSE') as COL4_ALLOW_SCAL, 
IFF(COL4_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL4_SHOW_UNT_IN_HEAD, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_WDTH_MAX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_WDTH_MIN, 
IFF(COL4_WDTH_FIX=1,'TRUE','FALSE') as COL4_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL4_INDENT, 
IFF(COL5_ALIGN_DEC=1,'TRUE','FALSE') as COL5_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_ALIGNMNT, 
IFF(COL5_ISEXPECTED=1,'TRUE','FALSE') as COL5_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_LBL,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_UNT, 
IFF(COL5_ALLOW_SCAL=1,'TRUE','FALSE') as COL5_ALLOW_SCAL, 
IFF(COL5_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL5_SHOW_UNT_IN_HEAD, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_WDTH_MAX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_WDTH_MIN, 
IFF(COL5_WDTH_FIX=1,'TRUE','FALSE') as COL5_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL5_INDENT, 
IFF(COL6_ALIGN_DEC=1,'TRUE','FALSE') as COL6_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_ALIGNMNT, 
IFF(COL6_ISEXPECTED=1,'TRUE','FALSE') as COL6_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_UNT, 
IFF(COL6_ALLOW_SCAL=1,'TRUE','FALSE') as COL6_ALLOW_SCAL, 
IFF(COL6_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL6_SHOW_UNT_IN_HEAD, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_WDTH_MIN, 
IFF(COL6_WDTH_FIX=1,'TRUE','FALSE') as COL6_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL6_INDENT, 
IFF(COL7_ALIGN_DEC=1,'TRUE','FALSE') as COL7_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_ALIGNMNT,
IFF(COL7_ISEXPECTED=1,'TRUE','FALSE') as COL7_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_CONTXT_NM,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_UNT, 
IFF(COL7_ALLOW_SCAL=1,'TRUE','FALSE') as COL7_ALLOW_SCAL, 
IFF(COL7_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL7_SHOW_UNT_IN_HEAD, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_WDTH_MAX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_WDTH_MIN,
IFF(COL7_WDTH_FIX=1,'TRUE','FALSE') as COL7_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL7_INDENT, 
IFF(COL8_ALIGN_DEC=1,'TRUE','FALSE') as COL8_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_ALIGNMNT, 
IFF(COL8_ISEXPECTED=1,'TRUE','FALSE') as COL8_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_UNT, 
IFF(COL8_ALLOW_SCAL=1,'TRUE','FALSE') as COL8_ALLOW_SCAL, 
IFF(COL8_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL8_SHOW_UNT_IN_HEAD, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_WDTH_MAX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_WDTH_MIN, 
IFF(COL8_WDTH_FIX=1,'TRUE','FALSE') as COL8_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL8_INDENT, 
IFF(COL9_ALIGN_DEC=1,'TRUE','FALSE') as COL9_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_ALIGNMNT, 
IFF(COL9_ISEXPECTED=1,'TRUE','FALSE') as COL9_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_UNT, 
IFF(COL9_ALLOW_SCAL=1,'TRUE','FALSE') as COL9_ALLOW_SCAL, 
IFF(COL9_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL9_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_WDTH_MIN,
IFF(COL9_WDTH_FIX=1,'TRUE','FALSE') as COL9_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL9_INDENT, 
IFF(COL10_ALIGN_DEC=1,'TRUE','FALSE') as COL10_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_ALIGNMNT, 
IFF(COL10_ISEXPECTED=1,'TRUE','FALSE') as COL10_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_UNT, 
IFF(COL10_ALLOW_SCAL=1,'TRUE','FALSE') as COL10_ALLOW_SCAL, 
IFF(COL10_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as COL10_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_WDTH_MIN, 
IFF(COL10_WDTH_FIX=1,'TRUE','FALSE') as COL10_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.COL10_INDENT, 
IFF(MIN_ALIGN_DEC=1,'TRUE','FALSE') as MIN_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_ALIGNMNT, 
IFF(MIN_ISEXPECTED=1,'TRUE','FALSE') as MIN_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_UNT, 
IFF(MIN_ALLOW_SCAL=1,'TRUE','FALSE') as MIN_ALLOW_SCAL, 
IFF(MIN_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as MIN_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_WDTH_MIN,
IFF(MIN_WDTH_FIX=1,'TRUE','FALSE') as MIN_WDTH_FIX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MIN_INDENT,
IFF(MSRD_ALIGN_DEC=1,'TRUE','FALSE') as MSRD_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_ALIGNMNT, 
IFF(MSRD_ISEXPECTED=1,'TRUE','FALSE') as MSRD_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_UNT,
IFF(MSRD_ALLOW_SCAL=1,'TRUE','FALSE') as MSRD_ALLOW_SCAL,
IFF(MSRD_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as MSRD_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_WDTH_MAX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_WDTH_MIN,
IFF(MSRD_WDTH_FIX=1,'TRUE','FALSE') as MSRD_WDTH_FIX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MSRD_INDENT, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_ALIGNMNT, 
IFF(MAX_ISEXPECTED=1,'TRUE','FALSE') as MAX_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_UNT, 
IFF(MAX_ALLOW_SCAL=1,'TRUE','FALSE') as MAX_ALLOW_SCAL,
IFF(MAX_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as MAX_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_WDTH, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_WDTH_MIN, 
IFF(MAX_WDTH_FIX=1,'TRUE','FALSE') as MAX_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.MAX_INDENT, 
APP_UN_ALIGN_DEC,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_ALIGNMNT, 
IFF(APP_UN_ISEXPECTED=1,'TRUE','FALSE') as APP_UN_ISEXPECTED, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_CONTXT_NM, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_NUM_OF_SGNFCNT_DIGITS, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_UNT,
IFF(APP_UN_ALLOW_SCAL=1,'TRUE','FALSE') as APP_UN_ALLOW_SCAL, 
IFF(APP_UN_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as APP_UN_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_WDTH_MIN,
IFF(APP_UN_WDTH_FIX=1,'TRUE','FALSE') as APP_UN_WDTH_FIX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.APP_UN_INDENT,
IFF(JUDG_ALIGN_DEC=1,'TRUE','FALSE') as JUDG_ALIGN_DEC, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_ALIGNMNT, 
IFF(JUDG_ISEXPECTED=1,'TRUE','FALSE') as JUDG_ISEXPECTED,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_CONTXT_NM,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_LBL, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_NUM_OF_SGNFCNT_DIGITS,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_UNT, 
IFF(JUDG_ALLOW_SCAL=1,'TRUE','FALSE') as JUDG_ALLOW_SCAL,
IFF(JUDG_SHOW_UNT_IN_HEAD=1,'TRUE','FALSE') as JUDG_SHOW_UNT_IN_HEAD,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_WDTH,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_WDTH_MAX,
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_WDTH_MIN, 
IFF(JUDG_WDTH_FIX=1,'TRUE','FALSE') as JUDG_WDTH_FIX, 
CA_TEST_DATA_SCTN_CLMN_TYP_STG.JUDG_INDENT, 
CA_TEST_DATA_SCTN_STG.TEST_DATA_ID, 
CA_TEST_DATA_SCTN_STG.CXKEY_TEST_DATA_SCTN_NM,
CA_TEST_DATA_SCTN_STG.CXKEY_SRVC_ORD_NUM,
CA_TEST_DATA_SCTN_STG.TEST_DATA_ID,
CA_TEST_DATA_SCTN_STG.LAST_MODIFIED_DT, 
CA_TEST_DATA_SCTN_STG.CXKEY_CAL_PROCEDURE_ID, 
CA_TEST_DATA_SCTN_STG.CXKEY_MFGR_ID, 
CA_TEST_DATA_SCTN_STG.CXKEY_MFGR_MDL_NUM,
CA_TEST_DATA_SCTN_STG.CXKEY_SR_NUM,
CA_TEST_DATA_SCTN_STG.CXKEY_FRMWRK_ID,
CA_TEST_DATA_SCTN_STG.CXKEY_SUBMITTING_ENTITY,
CA_TEST_DATA_SCTN_STG.CXKEY_APP_PLATFORM,
CA_TEST_DATA_SCTN_STG.CXKEY_APP_ID,
CA_TEST_DATA_SCTN_STG.CXKEY_CAL_TEST_RESLT_NM, 
CA_TEST_DATA_SCTN_STG.CXKEY_CAL_TEST_RESLT_TYP,
RESLT_TYP_DATAIS_COPY,
IS_CHARACTERIZATION_DATA
FROM {{ ref('ca_test_data_sctn_clmn_typ_stg') }} CA_TEST_DATA_SCTN_CLMN_TYP_STG,{{ ref('ca_test_data_sctn_stg') }} CA_TEST_DATA_SCTN_STG
WHERE
CA_TEST_DATA_SCTN_CLMN_TYP_STG.TEST_DATA_UNIQUE_ID=CA_TEST_DATA_SCTN_STG.TEST_DATA_ID AND CA_TEST_DATA_SCTN_CLMN_TYP_STG.TOT_COL_WDTH IS NOT NULL
),

lkp as(
select
TGT.TEST_DATA_SCTN_ID,
STG.TEST_DATA_UNIQUE_ID,
TOT_COL_WDTH,
TC_ALIGN_DEC,
TC_ALIGNMNT,
TC_ISEXPECTED,
TC_CONTXT_NM,
TC_LBL,
TC_NUM_OF_SGNFCNT_DIGITS,
TC_UNT,
TC_ALLOW_SCAL,
TC_SHOW_UNT_IN_HEAD,
TC_WDTH,
TC_WDTH_MAX,
TC_WDTH_MIN,
TC_WDTH_FIX,
TC_INDENT,
COL2_ALIGN_DEC,
COL2_ALIGNMNT,
COL2_ISEXPECTED,
COL2_CONTXT_NM,
COL2_LBL,
COL2_NUM_OF_SGNFCNT_DIGITS,
COL2_UNT,
COL2_ALLOW_SCAL,
COL2_SHOW_UNT_IN_HEAD,
COL2_WDTH,
COL2_WDTH_MAX,
COL2_WDTH_MIN,
COL2_WDTH_FIX,
COL2_INDENT,
COL3_ALIGN_DEC,
COL3_ALIGNMNT,
COL3_ISEXPECTED,
COL3_CONTXT_NM,
COL3_LBL,
COL3_NUM_OF_SGNFCNT_DIGITS,
COL3_UNT,
COL3_ALLOW_SCAL,
COL3_SHOW_UNT_IN_HEAD,
COL3_WDTH,
COL3_WDTH_MAX,
COL3_WDTH_MIN,
COL3_WDTH_FIX,
COL3_INDENT,
COL4_ALIGN_DEC,
COL4_ALIGNMNT,
COL4_ISEXPECTED,
COL4_CONTXT_NM,
COL4_LBL,
COL4_NUM_OF_SGNFCNT_DIGITS,
COL4_UNT,
COL4_ALLOW_SCAL,
COL4_SHOW_UNT_IN_HEAD,
COL4_WDTH,
COL4_WDTH_MAX,
COL4_WDTH_MIN,
COL4_WDTH_FIX,
COL4_INDENT,
COL5_ALIGN_DEC,
COL5_ALIGNMNT,
COL5_ISEXPECTED,
COL5_CONTXT_NM,
COL5_LBL,
COL5_NUM_OF_SGNFCNT_DIGITS,
COL5_UNT,
COL5_ALLOW_SCAL,
COL5_SHOW_UNT_IN_HEAD,
COL5_WDTH,
COL5_WDTH_MAX,
COL5_WDTH_MIN,
COL5_WDTH_FIX,
COL5_INDENT,
COL6_ALIGN_DEC,
COL6_ALIGNMNT,
COL6_ISEXPECTED,
COL6_CONTXT_NM,
COL6_LBL,
COL6_NUM_OF_SGNFCNT_DIGITS,
COL6_UNT,
COL6_ALLOW_SCAL,
COL6_SHOW_UNT_IN_HEAD,
COL6_WDTH,
COL6_WDTH_MAX,
COL6_WDTH_MIN,
COL6_WDTH_FIX,
COL6_INDENT,
COL7_ALIGN_DEC,
COL7_ALIGNMNT,
COL7_ISEXPECTED,
COL7_CONTXT_NM,
COL7_LBL,
COL7_NUM_OF_SGNFCNT_DIGITS,
COL7_UNT,
COL7_ALLOW_SCAL,
COL7_SHOW_UNT_IN_HEAD,
COL7_WDTH,
COL7_WDTH_MAX,
COL7_WDTH_MIN,
COL7_WDTH_FIX,
COL7_INDENT,
COL8_ALIGN_DEC,
COL8_ALIGNMNT,
COL8_ISEXPECTED,
COL8_CONTXT_NM,
COL8_LBL,
COL8_NUM_OF_SGNFCNT_DIGITS,
COL8_UNT,
COL8_ALLOW_SCAL,
COL8_SHOW_UNT_IN_HEAD,
COL8_WDTH,
COL8_WDTH_MAX,
COL8_WDTH_MIN,
COL8_WDTH_FIX,
COL8_INDENT,
COL9_ALIGN_DEC,
COL9_ALIGNMNT,
COL9_ISEXPECTED,
COL9_CONTXT_NM,
COL9_LBL,
COL9_NUM_OF_SGNFCNT_DIGITS,
COL9_UNT,
COL9_ALLOW_SCAL,
COL9_SHOW_UNT_IN_HEAD,
COL9_WDTH,
COL9_WDTH_MAX,
COL9_WDTH_MIN,
COL9_WDTH_FIX,
COL9_INDENT,
COL10_ALIGN_DEC,
COL10_ALIGNMNT,
COL10_ISEXPECTED,
COL10_CONTXT_NM,
COL10_LBL,
COL10_NUM_OF_SGNFCNT_DIGITS,
COL10_UNT,
COL10_ALLOW_SCAL,
COL10_SHOW_UNT_IN_HEAD,
COL10_WDTH,
COL10_WDTH_MAX,
COL10_WDTH_MIN,
COL10_WDTH_FIX,
COL10_INDENT,
MIN_ALIGN_DEC,
MIN_ALIGNMNT,
MIN_ISEXPECTED,
MIN_CONTXT_NM,
MIN_LBL,
MIN_NUM_OF_SGNFCNT_DIGITS,
MIN_UNT,
MIN_ALLOW_SCAL,
MIN_SHOW_UNT_IN_HEAD,
MIN_WDTH,
MIN_WDTH_MAX,
MIN_WDTH_MIN,
MIN_WDTH_FIX,
MIN_INDENT,
MSRD_ALIGN_DEC,
MSRD_ALIGNMNT,
MSRD_ISEXPECTED,
MSRD_CONTXT_NM,
MSRD_LBL,
MSRD_NUM_OF_SGNFCNT_DIGITS,
MSRD_UNT,
MSRD_ALLOW_SCAL,
MSRD_SHOW_UNT_IN_HEAD,
MSRD_WDTH,
MSRD_WDTH_MAX,
MSRD_WDTH_MIN,
MSRD_WDTH_FIX,
MSRD_INDENT,
MAX_ALIGN_DEC,
MAX_ALIGNMNT,
MAX_ISEXPECTED,
MAX_CONTXT_NM,
MAX_LBL,
MAX_NUM_OF_SGNFCNT_DIGITS,
MAX_UNT,
MAX_ALLOW_SCAL,
MAX_SHOW_UNT_IN_HEAD,
MAX_WDTH,
MAX_WDTH_MAX,
MAX_WDTH_MIN,
MAX_WDTH_FIX,
MAX_INDENT,
APP_UN_ALIGN_DEC,
APP_UN_ALIGNMNT,
APP_UN_ISEXPECTED,
APP_UN_CONTXT_NM,
APP_UN_LBL,
APP_UN_NUM_OF_SGNFCNT_DIGITS,
APP_UN_UNT,
APP_UN_ALLOW_SCAL,
APP_UN_SHOW_UNT_IN_HEAD,
APP_UN_WDTH,
APP_UN_WDTH_MAX,
APP_UN_WDTH_MIN,
APP_UN_WDTH_FIX,
APP_UN_INDENT,
JUDG_ALIGN_DEC,
JUDG_ALIGNMNT,
JUDG_ISEXPECTED,
JUDG_CONTXT_NM,
JUDG_LBL,
JUDG_NUM_OF_SGNFCNT_DIGITS,
JUDG_UNT,
JUDG_ALLOW_SCAL,
JUDG_SHOW_UNT_IN_HEAD,
JUDG_WDTH,
JUDG_WDTH_MAX,
JUDG_WDTH_MIN,
JUDG_WDTH_FIX,
JUDG_INDENT,
STG.CXKEY_SRVC_ORD_NUM,
STG.LAST_MODIFIED_DT,
STG.CXKEY_CAL_PROCEDURE_ID,
STG.CXKEY_MFGR_ID,
STG.CXKEY_MFGR_MDL_NUM,
STG.CXKEY_SR_NUM,
STG.CXKEY_FRMWRK_ID,
STG.CXKEY_SUBMITTING_ENTITY,
STG.CXKEY_APP_PLATFORM,
STG.CXKEY_APP_ID,
STG.CXKEY_CAL_TEST_RESLT_NM,
STG.CXKEY_CAL_TEST_RESLT_TYP,
STG.CXKEY_TEST_DATA_SCTN_NM 
from stg
LEFT OUTER JOIN {{ ref('ca_test_data_sctn') }} TGT ON
        STG.CXKEY_TEST_DATA_SCTN_NM = TGT.CXKEY_TEST_DATA_SCTN_NM AND
        STG.TEST_DATA_UNIQUE_ID = TGT.TEST_DATA_UNIQUE_ID AND
        STG.CXKEY_SRVC_ORD_NUM = TGT.CXKEY_SRVC_ORD_NUM AND
        STG.LAST_MODIFIED_DT = TGT.LAST_MODIFIED_DT AND
        STG.CXKEY_CAL_PROCEDURE_ID = TGT.CXKEY_CAL_PROCEDURE_ID AND
        STG.CXKEY_MFGR_ID = TGT.CXKEY_MFGR_ID AND
        STG.CXKEY_MFGR_MDL_NUM =  TGT.CXKEY_MFGR_MDL_NUM AND
        STG.CXKEY_SR_NUM = TGT.CXKEY_SR_NUM AND
        STG.CXKEY_FRMWRK_ID = TGT.CXKEY_FRMWRK_ID AND
        STG.CXKEY_SUBMITTING_ENTITY = TGT.CXKEY_SUBMITTING_ENTITY AND
        STG.CXKEY_CAL_TEST_RESLT_NM  = TGT.CXKEY_CAL_TEST_RESLT_NM AND
        STG.CXKEY_CAL_TEST_RESLT_TYP  = TGT.CXKEY_CAL_TEST_RESLT_TYP AND
        STG.CXKEY_APP_PLATFORM  = TGT.CXKEY_APP_PLATFORM AND
        STG.CXKEY_APP_ID  = TGT.CXKEY_APP_ID
) 
select distinct (CA_TEST_DATA_SCTN_CLMN_TYP_SEQ.nextval) as COLUMN_TYP_ID,* from lkp where TEST_DATA_SCTN_ID IS NOT NULL AND TOT_COL_WDTH IS NOT NULL
