
 {{
    config(
        materialized='incremental'
    )
}}

with join_1 as
(
  select 
    
stg1.UNT as MSRMNT_DATA_UNT,
stg1.UNT_MULTIPLIER as MSRMNT_DATA_UNT_MULTIPLIER ,
stg1.TEST_CONDITION as MSRMNT_DATA_TEST_CONDITION ,
stg1.CONDITION_2 as MSRMNT_DATA_CONDITION_2 ,
stg1.LWR_LMT as MSRMNT_DATA_LWR_LMT,
stg1.LWR_GURDBD_LMT as MSRMNT_DATA_LWR_GURDBD_LMT,
stg1.LWR_GURDBD_ADJUST_LMT as MSRMNT_DATA_LWR_GURDBD_ADJUST_LMT,
stg1.LWR_PRCSS_LMT as MSRMNT_DATA_LWR_PRCSS_LMT,
stg1.LWR_PRCSS_ADJUST_LMT as MSRMNT_DATA_LWR_PRCSS_ADJUST_LMT,
stg1.EXPT as MSRMNT_DATA_EXPT,
stg1.MSRD as MSRMNT_DATA_MSRD,
stg1.MSRMNT_NRMLZD as MSRMNT_DATA_MSRMNT_NRMLZD,
stg1.MSRMNT_PERCNT_OF_SPCFCTN as MSRMNT_DATA_MSRMNT_PERCNT_OF_SPCFCTN,
stg1.MSRMNT_COVERAGE_FACTOR as MSRMNT_DATA_MSRMNT_COVERAGE_FACTOR,
stg1.MSRMNT_TEST_UNCRTNTY_RATIO as MSRMNT_DATA_MSRMNT_TEST_UNCRTNTY_RATIO ,
stg1.MSRD_RAW_VAL as MSRMNT_DATA_MSRD_RAW_VAL,
stg1.UPR_LMT as MSRMNT_DATA_UPR_LMT ,
stg1.UPR_GURDBD_LMT as MSRMNT_DATA_UPR_GURDBD_LMT ,
stg1.UPR_GURDBD_ADJUST_LMT as MSRMNT_DATA_UPR_GURDBD_ADJUST_LMT,
stg1.UPR_PRCSS_LMT as MSRMNT_DATA_UPR_PRCSS_LMT,
stg1.UPR_PRCSS_ADJUST_LMT as MSRMNT_DATA_UPR_PRCSS_ADJUST_LMT,
stg1.UNCRTNTY as MSRMNT_DATA_UNCRTNTY,
stg1.UNCRTNTY_NM as MSRMNT_DATA_UNCRTNTY_NM ,
stg1.UNCRTNTY_METROLOGY_DATABASE as MSRMNT_DATA_UNCRTNTY_METROLOGY_DATABASE,
stg1.PRCSS_UNCRTNTY as MSRMNT_DATA_PRCSS_UNCRTNTY,
stg1.PRCSS_UNCRTNTY_NM as MSRMNT_DATA_PRCSS_UNCRTNTY_NM ,
stg1.GURDBD_VAL as MSRMNT_DATA_GURDBD_VAL,
stg1.GURDBD_VAL_TYP as MSRMNT_DATA_GURDBD_VAL_TYP,
stg1.GURDBD_ADJ_VAL as MSRMNT_DATA_GURDBD_ADJ_VAL,
stg1.GURDBD_ADJ_VAL_TYP as MSRMNT_DATA_GURDBD_ADJ_VAL_TYP ,
stg1.PRCSS_GURDBD_VAL as MSRMNT_DATA_PRCSS_GURDBD_VAL ,
stg1.PRCSS_GURDBD_VAL_TYP as MSRMNT_DATA_PRCSS_GURDBD_VAL_TYP,
stg1.IMPLIED_LWR_LMT as MSRMNT_DATA_IMPLIED_LWR_LMT,
stg1.IMPLIED_UPR_LMT as MSRMNT_DATA_IMPLIED_UPR_LMT,
stg1.OFFSET as MSRMNT_DATA_OFFSET,
stg1.DATA_ID as MSRMNT_DATA_DATA_ID,
stg1.SHORT_DATA_ID as MSRMNT_DATA_SHORT_DATA_ID,
stg1.LMTS_TYP as MSRMNT_DATA_LMTS_TYP,
stg1.NEAR_SPCFCTN_LMT_IND as MSRMNT_DATA_NEAR_SPCFCTN_LMT_IND,
stg1.NEAR_GURDBD_LMT_IND as MSRMNT_DATA_NEAR_GURDBD_LMT_IND,
stg1.MSRMNT_DATA_INDNTIFIER as MSRMNT_DATA_MSRMNT_DATA_INDNTIFIER,
stg1.NUM_OF_MSRMNT_SAMPLE as MSRMNT_DATA_NUM_OF_MSRMNT_SAMPLE,
stg1.STD_JDGMNT as MSRMNT_DATA_STD_JDGMNT,
stg1.GURDBD_JDGMNT as MSRMNT_DATA_GURDBD_JDGMNT ,
stg1.PRCSS_JDGMNT as MSRMNT_DATA_PRCSS_JDGMNT,
stg1.INSERT_DT as MSRMNT_DATA_INSERT_DT,
stg1.UPD_DT as MSRMNT_DATA_UPD_DT ,
stg1.MSRMNT_ID as MSRMNT_DATA_MSRMNT_ID,
stg1.CXKEY_SRVC_ORD_NUM as MSRMNT_DATA_CXKEY_SRVC_ORD_NUM ,
stg1.LAST_MODIFIED_DT as MSRMNT_DATA_LAST_MODIFIED_DT ,
stg1.CXKEY_CAL_PROCEDURE_ID as MSRMNT_DATA_CXKEY_CAL_PROCEDURE_ID,
stg1.CXKEY_MFGR_ID as MSRMNT_DATA_CXKEY_MFGR_ID,
stg1.CXKEY_MFGR_MDL_NUM as MSRMNT_DATA_CXKEY_MFGR_MDL_NUM ,
stg1.CXKEY_SR_NUM as MSRMNT_DATA_CXKEY_SR_NUM,
stg1.CXKEY_FRMWRK_ID as MSRMNT_DATA_CXKEY_FRMWRK_ID ,
stg1.CXKEY_SUBMITTING_ENTITY as MSRMNT_DATA_CXKEY_SUBMITTING_ENTITY ,
stg1.CXKEY_APP_PLATFORM as MSRMNT_DATA_CXKEY_APP_PLATFORM ,
stg1.CXKEY_APP_ID as MSRMNT_DATA_CXKEY_APP_ID,
stg1.CXKEY_CAL_TEST_RESLT_NM as MSRMNT_DATA_CXKEY_CAL_TEST_RESLT_NM ,
stg1.CXKEY_TEST_DATA_SCTN_NM as MSRMNT_DATA_CXKEY_TEST_DATA_SCTN_NM,
stg1.CXKEY_CAL_TEST_RESLT_TYP as MSRMNT_DATA_CXKEY_CAL_TEST_RESLT_TYP ,
stg1.PRCSS_GURDBD_ADJ_VAL as MSRMNT_DATA_PRCSS_GURDBD_ADJ_VAL,
stg1.PRCSS_GURDBD_ADJ_VAL_TYP as MSRMNT_DATA_PRCSS_GURDBD_ADJ_VAL_TYP,
stg1.CXKEY_TEST_DATA_SCTN_UNIQUE_ID as MSRMNT_DATA_CXKEY_TEST_DATA_SCTN_UNIQUE_ID,
stg1.ASRECDORCOMP_DATA_IND as MSRMNT_DATA_ASRECDORCOMP_DATA_IND,
stg1.CAL_TST_RPRTD_JDGMNT as MSRMNT_DATA_CAL_TST_RPRTD_JDGMNT,
stg1.AS_CMP_APPPLATFORM as MSRMNT_DATA_AS_CMP_APPPLATFORM,
stg1.AS_CMP_APP_ID as MSRMNT_DATA_AS_CMP_APP_ID,
stg1.AS_CMP_TST_DATA_SEC_ID as MSRMNT_DATA_AS_CMP_TST_DATA_SEC_ID,
stg1.AS_CMP_MEAS_RSLT_ID as MSRMNT_DATA_AS_CMP_MEAS_RSLT_ID,
stg1.AS_CMP_DATA_ID as MSRMNT_DATA_AS_CMP_DATA_ID ,
stg1.AS_CMP_PRCSS_JDGMNT as MSRMNT_DATA_AS_CMP_PRCSS_JDGMNT,
stg1.AS_CMP_SHRT_DATA_ID as MSRMNT_DATA_AS_CMP_SHRT_DATA_ID ,
stg1.AS_CMP_NR_GURDBD_LMT as MSRMNT_DATA_AS_CMP_NR_GURDBD_LMT ,
stg1.AS_CMP_NR_SPCFCTN_LMT as MSRMNT_DATA_AS_CMP_NR_SPCFCTN_LMT,
stg1.AS_CMP_GURDBD_JUDGMNT as MSRMNT_DATA_AS_CMP_GURDBD_JUDGMNT,
stg1.AS_CMP_LIMITS_TYPE as MSRMNT_DATA_AS_CMP_LIMITS_TYPE,
stg1.AS_CMP_STNDRD_JUDGMNT as MSRMNT_DATA_AS_CMP_STNDRD_JUDGMNT,
stg1.AS_CMP_UNITS as MSRMNT_DATA_AS_CMP_UNITS,
stg1.AS_CMP_UNT_MULT as MSRMNT_DATA_AS_CMP_UNT_MULT,
stg1.AS_CMP_TST_CND as MSRMNT_DATA_AS_CMP_TST_CND,
stg1.AS_CMP_CND as MSRMNT_DATA_AS_CMP_CND,
stg1.AS_CMP_LWR_LMT as MSRMNT_DATA_AS_CMP_LWR_LMT,
stg1.AS_CMP_LWR_GURDBD_LMT as MSRMNT_DATA_AS_CMP_LWR_GURDBD_LMT,
stg1.AS_CMP_LWR_GURDBD_ADJ_LMT as MSRMNT_DATA_AS_CMP_LWR_GURDBD_ADJ_LMT,
stg1.AS_CMP_LWR_PRCSS_LMT as MSRMNT_DATA_AS_CMP_LWR_PRCSS_LMT,
stg1.AS_CMP_LWR_PRCSS_ADJ_LMT as MSRMNT_DATA_AS_CMP_LWR_PRCSS_ADJ_LMT, 
stg1.AS_CMP_EXP as MSRMNT_DATA_AS_CMP_EXP,
stg1.AS_CMP_MSRD as MSRMNT_DATA_AS_CMP_MSRD ,
stg1.AS_CMP_PRCNT_OF_SPCFCTN as MSRMNT_DATA_AS_CMP_PRCNT_OF_SPCFCTN,
stg1.AS_CMP_NMR as MSRMNT_DATA_AS_CMP_NMR,
stg1.AS_CMP_ADJ_COVG_FCTR as MSRMNT_DATA_AS_CMP_ADJ_COVG_FCTR,
stg1.AS_CMP_TST_UNCRTNTY_RATIO as MSRMNT_DATA_AS_CMP_TST_UNCRTNTY_RATIO ,
stg1.AS_CMP_MSRD_RAW_VAL as MSRMNT_DATA_AS_CMP_MSRD_RAW_VAL,
stg1.AS_CMP_UPR_LMT as MSRMNT_DATA_AS_CMP_UPR_LMT,
stg1.AS_CMP_UPR_GURDBD_LMT as MSRMNT_DATA_AS_CMP_UPR_GURDBD_LMT,
stg1.AS_CMP_UPR_GURDBD_ADJ_LMT as MSRMNT_DATA_AS_CMP_UPR_GURDBD_ADJ_LMT,
stg1.AS_CMP_UPR_PRCSS_LMT as MSRMNT_DATA_AS_CMP_UPR_PRCSS_LMT,
stg1.AS_CMP_UPR_PRCSS_ADJ_LMT as MSRMNT_DATA_AS_CMP_UPR_PRCSS_ADJ_LMT,
stg1.AS_CMP_UNCRTNTY as MSRMNT_DATA_AS_CMP_UNCRTNTY,
stg1.AS_CMP_UNCRTNTY_NM as MSRMNT_DATA_AS_CMP_UNCRTNTY_NM,
stg1.AS_CMP_METROLOGY_DB as MSRMNT_DATA_AS_CMP_METROLOGY_DB,
stg1.AS_CMP_PRCSS_UNCRTNTY as MSRMNT_DATA_AS_CMP_PRCSS_UNCRTNTY,
stg1.AS_CMP_PRCSS_UNCRTNTY_NM as MSRMNT_DATA_AS_CMP_PRCSS_UNCRTNTY_NM,
stg1.AS_CMP_GURDBD_VAL as MSRMNT_DATA_AS_CMP_GURDBD_VAL ,
stg1.AS_CMP_GURDBD_VAL_TYP as MSRMNT_DATA_AS_CMP_GURDBD_VAL_TYP,
stg1.AS_CMP_ADJ_VAL as MSRMNT_DATA_AS_CMP_ADJ_VAL,
stg1.AS_CMP_ADJ_VAL_TYP as MSRMNT_DATA_AS_CMP_ADJ_VAL_TYP,
stg1.AS_CMP_PRCSS_GURDBD_VAL as MSRMNT_DATA_AS_CMP_PRCSS_GURDBD_VAL,
stg1.AS_CMP_PRCSS_GURDBD_VAL_TYP as MSRMNT_DATA_AS_CMP_PRCSS_GURDBD_VAL_TYP,
stg1.AS_CMP_PRCSS_GURDBD_ADJ_VAL as MSRMNT_DATA_AS_CMP_PRCSS_GURDBD_ADJ_VAL,
stg1.AS_CMP_PRCSS_GRDBD_ADJ_VAL_TYP as MSRMNT_DATA_AS_CMP_PRCSS_GRDBD_ADJ_VAL_TYP ,
stg1.AS_CMP_NUM_MEAS_SAMPLES as MSRMNT_DATA_AS_CMP_NUM_MEAS_SAMPLES,
stg1.AS_CMP_IMPLIED_LWR_LMT as MSRMNT_DATA_AS_CMP_IMPLIED_LWR_LMT,
stg1.AS_CMP_IMPLIED_UPR_LMT as MSRMNT_DATA_AS_CMP_IMPLIED_UPR_LMT,
stg1.AS_CMP_OFFSET as MSRMNT_DATA_AS_CMP_OFFSET ,
stg1.AS_CMP_CAL_TST_DATA_SCTN_NM as MSRMNT_DATA_AS_CMP_CAL_TST_DATA_SCTN_NM,
stg2.MSRMNT_SAMPLES_DESCR as MSRMNT_RESLT_MSRMNT_SAMPLES_DESCR,
stg2.IMPLIED_LWR_LMT as MSRMNT_RESLT_IMPLIED_LWR_LMT,
stg2.IMPLIED_UPR_LMT as MSRMNT_RESLT_IMPLIED_UPR_LMT ,
stg2.OFFSET as MSRMNT_RESLT_OFFSET,
stg2.COVERAGE_FACTOR as MSRMNT_RESLT_COVERAGE_FACTOR,
stg2.NEAR_SPCFCTN_LMT_IND as MSRMNT_RESLT_NEAR_SPCFCTN_LMT_IND,
stg2.NEAR_GURDBD_LMT_IND as MSRMNT_RESLT_NEAR_GURDBD_LMT_IND ,
stg2.MSRMNT_DATA_INDNTIFIER as MSRMNT_RESLT_MSRMNT_DATA_INDNTIFIER ,
stg2.STD_JDGMNT as MSRMNT_RESLT_STD_JDGMNT,
stg2.GURDBD_JDGMNT as MSRMNT_RESLT_GURDBD_JDGMNT,
stg2.PRCSS_JDGMNT as MSRMNT_RESLT_PRCSS_JDGMNT,
stg2.RPRTD_JDGMNT as MSRMNT_RESLT_RPRTD_JDGMNT,
stg2.INSERT_DT as MSRMNT_RESLT_INSERT_DT,
stg2.UPD_DT as MSRMNT_RESLT_UPD_DT,
stg2.TEST_COND_NAME as MSRMNT_RESLT_TEST_COND_NAME,
stg2.CXKEY_SRVC_ORD_NUM as MSRMNT_RESLT_CXKEY_SRVC_ORD_NUM,
stg2.LAST_MODIFIED_DT as MSRMNT_RESLT_LAST_MODIFIED_DT ,
stg2.CXKEY_CAL_PROCEDURE_ID as MSRMNT_RESLT_CXKEY_CAL_PROCEDURE_ID,
stg2.CXKEY_MFGR_ID as MSRMNT_RESLT_CXKEY_MFGR_ID,
stg2.CXKEY_MFGR_MDL_NUM as MSRMNT_RESLT_CXKEY_MFGR_MDL_NUM,
stg2.CXKEY_SR_NUM as MSRMNT_RESLT_CXKEY_SR_NUM,
stg2.CXKEY_FRMWRK_ID as MSRMNT_RESLT_CXKEY_FRMWRK_ID,
stg2.CXKEY_SUBMITTING_ENTITY as MSRMNT_RESLT_CXKEY_SUBMITTING_ENTITY,
stg2.CXKEY_CAL_TEST_RESLT_NM as MSRMNT_RESLT_CXKEY_CAL_TEST_RESLT_NM,
stg2.CXKEY_CAL_TEST_RESLT_TYP as MSRMNT_RESLT_CXKEY_CAL_TEST_RESLT_TYP,
stg2.CXKEY_APP_PLATFORM as MSRMNT_RESLT_CXKEY_APP_PLATFORM,
stg2.CXKEY_APP_ID as MSRMNT_RESLT_CXKEY_APP_ID,
stg2.CXKEY_TEST_DATA_SCTN_NM as MSRMNT_RESLT_CXKEY_TEST_DATA_SCTN_NM,
stg2.CXKEY_TEST_DATA_SCTN_UNIQUE_ID as MSRMNT_RESLT_CXKEY_TEST_DATA_SCTN_UNIQUE_ID,
stg2.TEST_CONDITION as MSRMNT_RESLT_TEST_CONDITION ,
stg2.CONDITION_2 as MSRMNT_RESLT_CONDITION_2,
stg2.ASRECDORCOMP_DATA_IND as MSRMNT_RESLT_ASRECDORCOMP_DATA_IND ,
stg2.CAL_TST_REPORTEDJUDGEMENT as MSRMNT_RESLT_CAL_TST_REPORTEDJUDGEMENT,
stg2.AS_CMP_APPPLATFORM as MSRMNT_RESLT_AS_CMP_APPPLATFORM,
stg2.AS_CMP_APPID as MSRMNT_RESLT_AS_CMP_APPID,
stg2.AS_CMP_TESTDATASECTION_ID as MSRMNT_RESLT_AS_CMP_TESTDATASECTION_ID,
stg2.AS_CMP_OFFSET as MSRMNT_RESLT_AS_CMP_OFFSET,
stg2.AS_CMP_NRSPECIFICATNLMT_IND as MSRMNT_RESLT_AS_CMP_NRSPECIFICATNLMT_IND,
stg2.AS_CMP_IMPLIEDUPPERLIMIT as MSRMNT_RESLT_AS_CMP_IMPLIEDUPPERLIMIT,
stg2.AS_CMP_IMPLIEDLOWERLIMIT as MSRMNT_RESLT_AS_CMP_IMPLIEDLOWERLIMIT,
stg2.AS_CMP_MEASRESULTID as MSRMNT_RESLT_AS_CMP_MEASRESULTID,
stg2.AS_CMP_NEARGUARDBANDLIMIT as MSRMNT_RESLT_AS_CMP_NEARGUARDBANDLIMIT,
stg2.AS_CMP_ADJUSTEDCOVERAGEFACTOR as MSRMNT_RESLT_AS_CMP_ADJUSTEDCOVERAGEFACTOR,
stg2.AS_CMP_TESTCONDITION_NM as MSRMNT_RESLT_AS_CMP_TESTCONDITION_NM,
stg2.AS_CMP_MEASUREMENTSAMPLES as MSRMNT_RESLT_AS_CMP_MEASUREMENTSAMPLES,
stg2.AS_CMP_JUDGEMENT as MSRMNT_RESLT_AS_CMP_JUDGEMENT,
stg2.AS_CMP_GUARDBANDJUDGEMENT as MSRMNT_RESLT_AS_CMP_GUARDBANDJUDGEMENT,
stg2.AS_CMP_PROCESSJUDGEMENT as MSRMNT_RESLT_AS_CMP_PROCESSJUDGEMENT,
stg2.AS_CMP_STANDARDJUDGEMENT as MSRMNT_RESLT_AS_CMP_STANDARDJUDGEMENT,
stg2.AS_CMP_TESTCONDITION as MSRMNT_RESLT_AS_CMP_TESTCONDITION,
stg2.AS_CMP_CONDITION as MSRMNT_RESLT_AS_CMP_CONDITION,
stg2.AS_CMP_NAME as MSRMNT_RESLT_AS_CMP_NAME,
stg2.MSRMNT_ID as MSRMNT_RESLT_MSRMNT_ID,
stg2.SHORT_DATA_ID as MSRMNT_RESLT_SHORT_DATA_ID,
stg2.MSRMNT_RESLT_ID as MSRMNT_RESLT_ID 
  
  from {{ ref('ca_msrmnt_data_stg') }}  STG1
  JOIN {{ ref('ca_msrmnt_reslt_stg') }}  STG2
  ON   
    --    //STG1.MSRMNT_DATA_INDNTIFIER = STG2.MSRMNT_DATA_INDNTIFIER AND
    --     //STG1.CXKEY_SRVC_ORD_NUM = STG2.CXKEY_SRVC_ORD_NUM AND
    --    // STG1.LAST_MODIFIED_DT = STG2.LAST_MODIFIED_DT AND
    --    // STG1.CXKEY_CAL_PROCEDURE_ID = STG2.CXKEY_CAL_PROCEDURE_ID AND
    --    //STG1.CXKEY_MFGR_ID = STG2.CXKEY_MFGR_ID AND
    --    //STG1.CXKEY_MFGR_MDL_NUM =  STG2.CXKEY_MFGR_MDL_NUM AND
    --    //STG1.CXKEY_SR_NUM = STG2.CXKEY_SR_NUM 
       STG1.CXKEY_FRMWRK_ID = STG2.CXKEY_FRMWRK_ID AND
    --   //STG1.CXKEY_SUBMITTING_ENTITY = STG2.CXKEY_SUBMITTING_ENTITY 
    --   //STG1.CXKEY_CAL_TEST_RESLT_NM  = STG2.CXKEY_CAL_TEST_RESLT_NM
    --    //STG1.CXKEY_CAL_TEST_RESLT_TYP  = STG2.CXKEY_CAL_TEST_RESLT_TYP AND
    --    //STG1.CXKEY_APP_PLATFORM  = STG2.CXKEY_APP_PLATFORM AND
    --    //STG1.CXKEY_APP_ID  = STG2.CXKEY_APP_ID AND 
      STG1.CXKEY_TEST_DATA_SCTN_NM = STG2.CXKEY_TEST_DATA_SCTN_NM
 ),
  renames as (
    select
      MSRMNT_RESLT_MSRMNT_SAMPLES_DESCR as MSRMNT_RESLT_MSRMNT_SAMPLES,
      MSRMNT_RESLT_IMPLIED_LWR_LMT,
      MSRMNT_RESLT_IMPLIED_UPR_LMT,
      MSRMNT_RESLT_OFFSET,
      MSRMNT_RESLT_COVERAGE_FACTOR,
      MSRMNT_RESLT_NEAR_SPCFCTN_LMT_IND as MSRMNT_RESLT_NEAR_SPCFCTN_LMT,
      MSRMNT_RESLT_NEAR_GURDBD_LMT_IND as MSRMNT_RESLT_NEAR_GURDBD_LMT_I,
    --   //CA_MSRMNT_RESLT_AND_DATA_FACT_SEQ.nextval as MSRMNT_RESLT_AND_DATA_ID
      MSRMNT_RESLT_RPRTD_JDGMNT,
      MSRMNT_RESLT_STD_JDGMNT,
      MSRMNT_RESLT_GURDBD_JDGMNT,
      MSRMNT_RESLT_PRCSS_JDGMNT,
      MSRMNT_DATA_UNT,
      MSRMNT_DATA_UNT_MULTIPLIER,
      MSRMNT_DATA_TEST_CONDITION as MSRMNT_DATA_TEST_COND,
      MSRMNT_DATA_CONDITION_2 as MSRMNT_DATA_COND_2,
      MSRMNT_DATA_LWR_LMT,
      MSRMNT_DATA_LWR_GURDBD_LMT,
      MSRMNT_DATA_LWR_GURDBD_ADJUST_LMT as MSRMNT_DATA_LWR_GURDBD_ADJUST,
      MSRMNT_DATA_LWR_PRCSS_LMT,
      MSRMNT_DATA_LWR_PRCSS_ADJUST_LMT as MSRMNT_DATA_LWR_PRCSS_ADJUST_L,
      MSRMNT_DATA_EXPT,
      MSRMNT_DATA_MSRD,
      MSRMNT_DATA_MSRMNT_NRMLZD as MSRMNT_DATA_NRMLZD,
      MSRMNT_DATA_MSRMNT_PERCNT_OF_SPCFCTN as MSRMNT_DATA_PERCNT_OF_SPCFCTN,
      MSRMNT_DATA_MSRMNT_COVERAGE_FACTOR as MSRMNT_DATA_COVERAGE_FACTOR,
      MSRMNT_DATA_MSRMNT_TEST_UNCRTNTY_RATIO as MSRMNT_DATA_TEST_UNCRTNTY_RATI,
      MSRMNT_DATA_MSRD_RAW_VAL,
      MSRMNT_DATA_UPR_LMT,
      MSRMNT_DATA_UPR_GURDBD_LMT,
      MSRMNT_DATA_UPR_GURDBD_ADJUST_LMT as MSRMNT_DATA_UPR_GURDBD_ADJUST,
      MSRMNT_DATA_UPR_PRCSS_LMT,
      MSRMNT_DATA_UPR_PRCSS_ADJUST_LMT as MSRMNT_DATA_UPR_PRCSS_ADJUST_L,
      MSRMNT_DATA_UNCRTNTY,
      MSRMNT_DATA_UNCRTNTY_NM,
      MSRMNT_DATA_UNCRTNTY_METROLOGY_DATABASE as MSRMNT_DATA_UNCRTNTY_METROLOGY,
      MSRMNT_DATA_PRCSS_UNCRTNTY,
      MSRMNT_DATA_GURDBD_VAL,
      MSRMNT_DATA_GURDBD_VAL_TYP,
      MSRMNT_DATA_GURDBD_ADJ_VAL,
      MSRMNT_DATA_PRCSS_GURDBD_VAL,
      MSRMNT_DATA_NUM_OF_MSRMNT_SAMPLE as MSRMNT_DATA_NUM_OF_MSRMNT_SAMP,
      MSRMNT_DATA_DATA_ID,
      MSRMNT_DATA_SHORT_DATA_ID,
      MSRMNT_DATA_LMTS_TYP,
      MSRMNT_DATA_STD_JDGMNT,
      MSRMNT_DATA_GURDBD_JDGMNT,
      MSRMNT_DATA_PRCSS_JDGMNT,
      MSRMNT_DATA_NEAR_GURDBD_LMT_IND as MSRMNT_DATA_NEAR_GURDBD_LMT_IN,
      MSRMNT_DATA_IMPLIED_LWR_LMT,
      MSRMNT_DATA_IMPLIED_UPR_LMT,
      MSRMNT_DATA_OFFSET,
      MSRMNT_DATA_NEAR_SPCFCTN_LMT_IND as MSRMNT_DATA_NEAR_SPCFCTN_LMT_I,
    --   //	TEST_DATA_SCTN_ID,
    --   //	UNT_ID,
    --   //	CAL_DT,
    --   //	SRVC_PRVDR_ID,
    --   //	CAL_PROCEDURE_ID,
    --   //	CUST_ID,
      MSRMNT_DATA_PRCSS_UNCRTNTY_NM,
      MSRMNT_DATA_GURDBD_ADJ_VAL_TYP,
      MSRMNT_DATA_PRCSS_GURDBD_VAL_TYP as MSRMNT_DATA_PRCSS_GURDBD_VAL_T,
      MSRMNT_DATA_AS_CMP_MEAS_RSLT_ID as MSRMNT_UNIQUE_ID,
      MSRMNT_DATA_CXKEY_SRVC_ORD_NUM as CXKEY_SRVC_ORD_NUM,
      MSRMNT_DATA_LAST_MODIFIED_DT as LAST_MODIFIED_DT,
      MSRMNT_DATA_CXKEY_CAL_PROCEDURE_ID as CXKEY_CAL_PROCEDURE_ID,
      MSRMNT_DATA_CXKEY_MFGR_ID as CXKEY_MFGR_ID,
      MSRMNT_DATA_CXKEY_MFGR_MDL_NUM as CXKEY_MFGR_MDL_NUM,
      MSRMNT_DATA_CXKEY_SR_NUM as CXKEY_SR_NUM,
      MSRMNT_DATA_CXKEY_FRMWRK_ID as CXKEY_FRMWRK_ID,
      MSRMNT_DATA_CXKEY_SUBMITTING_ENTITY as CXKEY_SUBMITTING_ENTITY,
      MSRMNT_DATA_CXKEY_APP_PLATFORM as CXKEY_APP_PLATFORM,
      MSRMNT_DATA_CXKEY_APP_ID as CXKEY_APP_ID,
      MSRMNT_DATA_CXKEY_CAL_TEST_RESLT_NM as CXKEY_CAL_TEST_RESLT_NM,
      MSRMNT_DATA_CXKEY_TEST_DATA_SCTN_NM as CXKEY_TEST_DATA_SCTN_NM, 
      MSRMNT_DATA_CXKEY_CAL_TEST_RESLT_TYP as CXKEY_CAL_TEST_RESLT_TYP,
      MSRMNT_DATA_ASRECDORCOMP_DATA_IND as ASRECDORCOMP_DATA_IND,
      MSRMNT_DATA_PRCSS_GURDBD_ADJ_VAL as MSRMNT_DATA_PRCSS_GDBD_ADJ_VAL,
      MSRMNT_DATA_PRCSS_GURDBD_ADJ_VAL_TYP as MSRMNT_DTA_PRCSS_GDBD_ADJ_VL_T,
      MSRMNT_DATA_MSRMNT_ID as CXKEY_MSRMNT_ID
 from join_1
 ),
 lkp as (
   SELECT 
      MSRMNT_RESLT_MSRMNT_SAMPLES,
      MSRMNT_RESLT_IMPLIED_LWR_LMT,
      MSRMNT_RESLT_IMPLIED_UPR_LMT,
      MSRMNT_RESLT_OFFSET,
      MSRMNT_RESLT_COVERAGE_FACTOR,
      MSRMNT_RESLT_NEAR_SPCFCTN_LMT,
      MSRMNT_RESLT_NEAR_GURDBD_LMT_I,
    --   CA_MSRMNT_RESLT_AND_DATA_FACT_SEQ.nextval as MSRMNT_RESLT_AND_DATA_ID
      MSRMNT_RESLT_RPRTD_JDGMNT,
      MSRMNT_RESLT_STD_JDGMNT,
      MSRMNT_RESLT_GURDBD_JDGMNT,
      MSRMNT_RESLT_PRCSS_JDGMNT,
      MSRMNT_DATA_UNT,
      MSRMNT_DATA_UNT_MULTIPLIER,
      MSRMNT_DATA_TEST_COND,
      MSRMNT_DATA_COND_2,
      MSRMNT_DATA_LWR_LMT,
      MSRMNT_DATA_LWR_GURDBD_LMT,
      MSRMNT_DATA_LWR_GURDBD_ADJUST,
      MSRMNT_DATA_LWR_PRCSS_LMT,
      MSRMNT_DATA_LWR_PRCSS_ADJUST_L,
      MSRMNT_DATA_EXPT,
      MSRMNT_DATA_MSRD,
      MSRMNT_DATA_NRMLZD,
      MSRMNT_DATA_PERCNT_OF_SPCFCTN,
      MSRMNT_DATA_COVERAGE_FACTOR,
      MSRMNT_DATA_TEST_UNCRTNTY_RATI,
      MSRMNT_DATA_MSRD_RAW_VAL,
      MSRMNT_DATA_UPR_LMT,
      MSRMNT_DATA_UPR_GURDBD_LMT,
      MSRMNT_DATA_UPR_GURDBD_ADJUST,
      MSRMNT_DATA_UPR_PRCSS_LMT,
      MSRMNT_DATA_UPR_PRCSS_ADJUST_L,
      MSRMNT_DATA_UNCRTNTY,
      MSRMNT_DATA_UNCRTNTY_NM,
      MSRMNT_DATA_UNCRTNTY_METROLOGY,
      MSRMNT_DATA_PRCSS_UNCRTNTY,
      MSRMNT_DATA_GURDBD_VAL,
      MSRMNT_DATA_GURDBD_VAL_TYP,
      MSRMNT_DATA_GURDBD_ADJ_VAL,
      MSRMNT_DATA_PRCSS_GURDBD_VAL,
      MSRMNT_DATA_NUM_OF_MSRMNT_SAMP,
      MSRMNT_DATA_DATA_ID,
      MSRMNT_DATA_SHORT_DATA_ID,
      MSRMNT_DATA_LMTS_TYP,
      MSRMNT_DATA_STD_JDGMNT,
      MSRMNT_DATA_GURDBD_JDGMNT,
      MSRMNT_DATA_PRCSS_JDGMNT,
      MSRMNT_DATA_NEAR_GURDBD_LMT_IN,
      MSRMNT_DATA_IMPLIED_LWR_LMT,
      MSRMNT_DATA_IMPLIED_UPR_LMT,
      MSRMNT_DATA_OFFSET,
      MSRMNT_DATA_NEAR_SPCFCTN_LMT_I,
      TEST_DATA_SCTN_ID,
      UNT_ID,
      CAL_DT,
      SRVC_PRVDR_ID,
      CAL_PROCEDURE_ID,
      CUST_ID,
      MSRMNT_DATA_PRCSS_UNCRTNTY_NM,
      MSRMNT_DATA_GURDBD_ADJ_VAL_TYP,
      MSRMNT_DATA_PRCSS_GURDBD_VAL_T,
      MSRMNT_UNIQUE_ID,
      renames.CXKEY_SRVC_ORD_NUM,
      renames.LAST_MODIFIED_DT,
      renames.CXKEY_CAL_PROCEDURE_ID,
      renames.CXKEY_MFGR_ID,
      renames.CXKEY_MFGR_MDL_NUM,
      renames.CXKEY_SR_NUM,
      renames.CXKEY_FRMWRK_ID,
      renames.CXKEY_SUBMITTING_ENTITY,
      renames.CXKEY_APP_PLATFORM,
      renames.CXKEY_APP_ID,
      renames.CXKEY_CAL_TEST_RESLT_NM,
      renames.CXKEY_TEST_DATA_SCTN_NM,
      renames.CXKEY_CAL_TEST_RESLT_TYP,
      renames.ASRECDORCOMP_DATA_IND,
      renames.MSRMNT_DATA_PRCSS_GDBD_ADJ_VAL,
      renames.MSRMNT_DTA_PRCSS_GDBD_ADJ_VL_T,
      renames.CXKEY_MSRMNT_ID
-- //        CA_TEST_DATA_SCTN.TEST_DATA_SCTN_ID as TEST_DATA_SCTN_ID, 
-- // CA_TEST_DATA_SCTN.SRVC_PRVDR_ID as SRVC_PRVDR_ID, 
-- // CA_TEST_DATA_SCTN.UNT_ID as UNT_ID, 
-- // CA_TEST_DATA_SCTN.CUST_ID as CUST_ID,
-- // CA_TEST_DATA_SCTN.CAL_PROCEDURE_ID as 
-- // CAL_PROCEDURE_ID, CA_TEST_DATA_SCTN.CAL_DT as CAL_DT,
-- // CA_TEST_DATA_SCTN.CXKEY_SRVC_ORD_NUM as CXKEY_SRVC_ORD_NUM, 
-- // CA_TEST_DATA_SCTN.LAST_MODIFIED_DT as LAST_MODIFIED_DT, 
-- // CA_TEST_DATA_SCTN.CXKEY_CAL_PROCEDURE_ID as CXKEY_CAL_PROCEDURE_ID, 
-- // CA_TEST_DATA_SCTN.CXKEY_MFGR_ID as CXKEY_MFGR_ID, 
-- // CA_TEST_DATA_SCTN.CXKEY_MFGR_MDL_NUM as CXKEY_MFGR_MDL_NUM, 
-- // CA_TEST_DATA_SCTN.CXKEY_SR_NUM as CXKEY_SR_NUM, 
-- // CA_TEST_DATA_SCTN.CXKEY_FRMWRK_ID as CXKEY_FRMWRK_ID,
-- // CA_TEST_DATA_SCTN.CXKEY_SUBMITTING_ENTITY as CXKEY_SUBMITTING_ENTITY,
-- // CA_TEST_DATA_SCTN.CXKEY_CAL_TEST_RESLT_NM as CXKEY_CAL_TEST_RESLT_NM,
-- // CA_TEST_DATA_SCTN.CXKEY_CAL_TEST_RESLT_TYP as CXKEY_CAL_TEST_RESLT_TYP, 
-- // CA_TEST_DATA_SCTN.CXKEY_APP_PLATFORM as CXKEY_APP_PLATFORM, 
-- // CA_TEST_DATA_SCTN.CXKEY_APP_ID as CXKEY_APP_ID, 
-- // CA_TEST_DATA_SCTN.CXKEY_TEST_DATA_SCTN_NM as CXKEY_TEST_DATA_SCTN_NM 
    FROM renames LEFT OUTER JOIN {{ ref('ca_test_data_sctn') }} CA_TEST_DATA_SCTN ON
        CA_TEST_DATA_SCTN.CXKEY_SRVC_ORD_NUM = renames.CXKEY_SRVC_ORD_NUM AND 
        CA_TEST_DATA_SCTN.LAST_MODIFIED_DT = renames.LAST_MODIFIED_DT AND  
        CA_TEST_DATA_SCTN.CXKEY_CAL_PROCEDURE_ID = renames.CXKEY_CAL_PROCEDURE_ID AND  
        CA_TEST_DATA_SCTN.CXKEY_MFGR_MDL_NUM = renames.CXKEY_MFGR_MDL_NUM AND 
        CA_TEST_DATA_SCTN.CXKEY_SR_NUM = renames.CXKEY_SR_NUM AND 
        CA_TEST_DATA_SCTN.CXKEY_FRMWRK_ID = renames.CXKEY_FRMWRK_ID AND 
        CA_TEST_DATA_SCTN.CXKEY_SUBMITTING_ENTITY = renames.CXKEY_SUBMITTING_ENTITY AND 
        CA_TEST_DATA_SCTN.CXKEY_CAL_TEST_RESLT_NM = renames.CXKEY_CAL_TEST_RESLT_NM AND 
        CA_TEST_DATA_SCTN.CXKEY_CAL_TEST_RESLT_TYP = renames.CXKEY_CAL_TEST_RESLT_TYP AND  
        CA_TEST_DATA_SCTN.CXKEY_APP_PLATFORM = renames.CXKEY_APP_PLATFORM AND 
        CA_TEST_DATA_SCTN.CXKEY_APP_ID = renames.CXKEY_APP_ID AND 
        CA_TEST_DATA_SCTN.CXKEY_TEST_DATA_SCTN_NM = renames.CXKEY_TEST_DATA_SCTN_NM 
    
   ), final as (
    select distinct * from lkp

   ) select distinct
   MSRMNT_RESLT_MSRMNT_SAMPLES,
	MSRMNT_RESLT_IMPLIED_LWR_LMT,
	MSRMNT_RESLT_IMPLIED_UPR_LMT,
	MSRMNT_RESLT_OFFSET,
	MSRMNT_RESLT_COVERAGE_FACTOR,
	MSRMNT_RESLT_NEAR_SPCFCTN_LMT,
	MSRMNT_RESLT_NEAR_GURDBD_LMT_I,
	CA_MSRMNT_RESLT_AND_DATA_FACT_SEQ.nextval as MSRMNT_RESLT_AND_DATA_ID,
	MSRMNT_RESLT_RPRTD_JDGMNT,
	MSRMNT_RESLT_STD_JDGMNT,
	MSRMNT_RESLT_GURDBD_JDGMNT,
	MSRMNT_RESLT_PRCSS_JDGMNT,
	MSRMNT_DATA_UNT,
	MSRMNT_DATA_UNT_MULTIPLIER,
	MSRMNT_DATA_TEST_COND,
	MSRMNT_DATA_COND_2,
	MSRMNT_DATA_LWR_LMT,
	MSRMNT_DATA_LWR_GURDBD_LMT,
	MSRMNT_DATA_LWR_GURDBD_ADJUST,
	MSRMNT_DATA_LWR_PRCSS_LMT,
	MSRMNT_DATA_LWR_PRCSS_ADJUST_L,
	MSRMNT_DATA_EXPT,
	MSRMNT_DATA_MSRD,
	MSRMNT_DATA_NRMLZD,
	MSRMNT_DATA_PERCNT_OF_SPCFCTN,
	MSRMNT_DATA_COVERAGE_FACTOR,
	MSRMNT_DATA_TEST_UNCRTNTY_RATI,
	MSRMNT_DATA_MSRD_RAW_VAL,
	MSRMNT_DATA_UPR_LMT,
	MSRMNT_DATA_UPR_GURDBD_LMT,
	MSRMNT_DATA_UPR_GURDBD_ADJUST,
	MSRMNT_DATA_UPR_PRCSS_LMT,
	MSRMNT_DATA_UPR_PRCSS_ADJUST_L,
	MSRMNT_DATA_UNCRTNTY,
	MSRMNT_DATA_UNCRTNTY_NM,
	MSRMNT_DATA_UNCRTNTY_METROLOGY,
	MSRMNT_DATA_PRCSS_UNCRTNTY,
	MSRMNT_DATA_GURDBD_VAL,
	MSRMNT_DATA_GURDBD_VAL_TYP,
	MSRMNT_DATA_GURDBD_ADJ_VAL,
	MSRMNT_DATA_PRCSS_GURDBD_VAL,
	MSRMNT_DATA_NUM_OF_MSRMNT_SAMP,
	MSRMNT_DATA_DATA_ID,
	MSRMNT_DATA_SHORT_DATA_ID,
	MSRMNT_DATA_LMTS_TYP,
	MSRMNT_DATA_STD_JDGMNT,
	MSRMNT_DATA_GURDBD_JDGMNT,
	MSRMNT_DATA_PRCSS_JDGMNT,
	MSRMNT_DATA_NEAR_GURDBD_LMT_IN,
	MSRMNT_DATA_IMPLIED_LWR_LMT,
	MSRMNT_DATA_IMPLIED_UPR_LMT,
	MSRMNT_DATA_OFFSET,
	MSRMNT_DATA_NEAR_SPCFCTN_LMT_I,
	TEST_DATA_SCTN_ID,
	UNT_ID,
	CAL_DT,
	SRVC_PRVDR_ID,
	CAL_PROCEDURE_ID,
	CUST_ID,
	MSRMNT_DATA_PRCSS_UNCRTNTY_NM,
	MSRMNT_DATA_GURDBD_ADJ_VAL_TYP,
	MSRMNT_DATA_PRCSS_GURDBD_VAL_T,
	MSRMNT_UNIQUE_ID,
	CXKEY_SRVC_ORD_NUM,
	LAST_MODIFIED_DT,
	CXKEY_CAL_PROCEDURE_ID,
	CXKEY_MFGR_ID,
	CXKEY_MFGR_MDL_NUM,
	CXKEY_SR_NUM,
	CXKEY_FRMWRK_ID,
	CXKEY_SUBMITTING_ENTITY,
	CXKEY_APP_PLATFORM,
	CXKEY_APP_ID,
	CXKEY_CAL_TEST_RESLT_NM,
	CXKEY_TEST_DATA_SCTN_NM,
	CXKEY_CAL_TEST_RESLT_TYP,
	ASRECDORCOMP_DATA_IND,
	MSRMNT_DATA_PRCSS_GDBD_ADJ_VAL,
	MSRMNT_DTA_PRCSS_GDBD_ADJ_VL_T,
	CXKEY_MSRMNT_ID
   from final 